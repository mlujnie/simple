<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>simple package &mdash; SIMPLE 0.1.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SIMPLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">simple package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-simple.config">simple.config module</a></li>
<li><a class="reference internal" href="#module-simple.pk_3d_model">simple.pk_3d_model module</a></li>
<li><a class="reference internal" href="#module-simple.run_lognormal_galaxies">simple.run_lognormal_galaxies module</a></li>
<li><a class="reference internal" href="#module-simple.simple">simple.simple module</a></li>
<li><a class="reference internal" href="#module-simple.tools">simple.tools module</a></li>
<li><a class="reference internal" href="#module-simple.tools_python">simple.tools_python module</a></li>
<li><a class="reference internal" href="#module-simple">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SIMPLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">simple package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/build/simple.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="simple-package">
<h1>simple package<a class="headerlink" href="#simple-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-simple.config">
<span id="simple-config-module"></span><h2>simple.config module<a class="headerlink" href="#module-simple.config" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="simple.config.Config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">simple.config.</span></span><span class="sig-name descname"><span class="pre">Config</span></span><a class="headerlink" href="#simple.config.Config" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Configuration class to find the installation directory of lognormal_galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>lognormal_galaxies_path</strong> (<em>str</em>) – Installation directory of lognormal_galaxies.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-simple.pk_3d_model">
<span id="simple-pk-3d-model-module"></span><h2>simple.pk_3d_model module<a class="headerlink" href="#module-simple.pk_3d_model" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">simple.pk_3d_model.</span></span><span class="sig-name descname"><span class="pre">Power_Spectrum_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_model_shot_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#simple.simple.LognormalIntensityMock" title="simple.simple.LognormalIntensityMock"><code class="xref py py-class docutils literal notranslate"><span class="pre">LognormalIntensityMock</span></code></a></p>
<p>Power_Spectrum_Model class.
Models the intensity/galaxy/cross power spectrum of a LognormalIntensityMock instance
with the same input parameters as that.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dict</strong> – Input parameters for the LognormalIntensityMock instance, see simple.py.</p></li>
<li><p><strong>do_model_shot_noise</strong> (<em>bool</em>) – Set to True to model the shot noise by shuffling the galaxy positions perpendicular to the LOS.
Default is None/False.</p></li>
<li><p><strong>out_filename</strong> (<em>str</em>) – Name of the file to save the model power spectra to (hdf5 format).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The general model is explained in the paper.</p>
<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.D_cic_corr">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">D_cic_corr</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.D_cic_corr" title="Permalink to this definition"></a></dt>
<dd><p>Damping function D for cic resampling evaluated for this instance as a 3D array.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.D_cic_of_k">
<span class="sig-name descname"><span class="pre">D_cic_of_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.D_cic_of_k" title="Permalink to this definition"></a></dt>
<dd><p>Damping function D for cic resampling with the aliasing correction for the shot noise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.D_sq_par_of_k">
<span class="sig-name descname"><span class="pre">D_sq_par_of_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.D_sq_par_of_k" title="Permalink to this definition"></a></dt>
<dd><p>Damping function D^2 for LOS-parallel top-hat smoothing with smoothing length s_par.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.D_sq_perp_of_k">
<span class="sig-name descname"><span class="pre">D_sq_perp_of_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_perp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_perp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.D_sq_perp_of_k" title="Permalink to this definition"></a></dt>
<dd><p>Damping function D^2 for LOS-perpendicular exponential smoothing with smoothing length s_perp.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.D_sq_tophat_of_k">
<span class="sig-name descname"><span class="pre">D_sq_tophat_of_k</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_perp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_perp_sky</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.D_sq_tophat_of_k" title="Permalink to this definition"></a></dt>
<dd><p>Damping function D^2 for a spherical top-hat smoothing in the directions perpendicular to the LOS.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.Pm_kspec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Pm_kspec</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.Pm_kspec" title="Permalink to this definition"></a></dt>
<dd><p>Cached property that returns the galaxy power spectrum Pm_kspec.
If self.RSD is True, it will return the Kaiser RSD approximation.
Otherwise it will be just the bias squared times the matter power spectrum.</p>
<dl class="simple">
<dt>astropy quantity array</dt><dd><p>The power spectrum Pm_kspec.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_meshes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['noise_mesh',</span> <span class="pre">'obs_mask']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_model_shot_noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Method to initiate a Power_Spectrum_Model object from a file
containing a saved LognormalIntensityMock object.</p>
<dl class="simple">
<dt>filename<span class="classifier">str</span></dt><dd><p>Name of the file containing the saved LognormalIntensityMock object.</p>
</dd>
<dt>out_filename<span class="classifier">str</span></dt><dd><p>Output filename for the power spectrum results.</p>
</dd>
<dt>catalog_filename<span class="classifier">str, optional</span></dt><dd><p>Filename of the catalog associated with the LognormalIntensityMock object.</p>
</dd>
<dt>only_params<span class="classifier">bool, optional</span></dt><dd><p>Set to True to load only the parameters and skip loading the meshes.</p>
</dd>
<dt>only_meshes<span class="classifier">list of str, optional</span></dt><dd><p>List of specific meshes to load. Default is [“noise_mesh”, “obs_mask”].</p>
</dd>
<dt>do_model_shot_noise<span class="classifier">bool, optional</span></dt><dd><p>Set to True to model the shot noise by shuffling the galaxy positions perpendicular to the LOS.
Default is None/False.</p>
</dd>
</dl>
<dl class="simple">
<dt>instance<span class="classifier">Power_Spectrum_Model</span></dt><dd><p>An instance of the Power_Spectrum_Model class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_3d_pk_model">
<span class="sig-name descname"><span class="pre">get_3d_pk_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">damping_function</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P_shot_smoothed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_bar</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_window_function_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observed_volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Pk_unit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convolve</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_window_function_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_3d_pk_model" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the 3D power spectrum model P(k) by incorporating smoothing, convolution with the window function,
and noise, and bins it in linear k bins.</p>
<dl class="simple">
<dt>damping_function<span class="classifier">array-like</span></dt><dd><p>The damping function.</p>
</dd>
<dt>P_shot_smoothed<span class="classifier">astropy quantity scalar or array</span></dt><dd><p>The shot noise power spectrum that is subject to smoothing (i.e. not pixel noise) in volume units.</p>
</dd>
<dt>S_bar<span class="classifier">float</span></dt><dd><p>The value of S_bar.</p>
</dd>
<dt>mask_window_function_1<span class="classifier">array-like</span></dt><dd><p>The window function: mask times mean field as a function of position.</p>
</dd>
<dt>observed_volume<span class="classifier">astropy quantity</span></dt><dd><p>The observed volume in volume units.</p>
</dd>
<dt>box_volume<span class="classifier">astropy quantity</span></dt><dd><p>The total box volume in volume units.</p>
</dd>
<dt>Pk_unit<span class="classifier">astropy unit object</span></dt><dd><p>The unit of the power spectrum (e.g. u.Unit(“u.Mpc**3”))</p>
</dd>
<dt>convolve<span class="classifier">bool, optional</span></dt><dd><p>Flag indicating whether to convolve P(k) with the window function squared.
If False, just multiply by Q_bar (mean of the window function squared).
Default is True.</p>
</dd>
<dt>mask_window_function_2<span class="classifier">array-like, optional</span></dt><dd><p>The window function for the second field in case of a cross power spectrum.
Default: None.</p>
</dd>
<dt>save<span class="classifier">bool, optional</span></dt><dd><p>Flag indicating whether to save the results. Default is True.</p>
</dd>
<dt>tracer<span class="classifier">str, optional</span></dt><dd><p>Options: n_gal, intensity, cross, sky_subtracted_intensity, sky_subtracted_cross.
The tracer label in the saved file. Default is None.</p>
</dd>
<dt>return_3d: bool, optional</dt><dd><p>Set to True if you want to return the 3D model as well.</p>
</dd>
</dl>
<dl class="simple">
<dt>mean_k</dt><dd><p>Mean k in the k bins.</p>
</dd>
<dt>monopole</dt><dd><p>Monopole moment of the binned power spectrum.</p>
</dd>
<dt>quadrupole</dt><dd><p>Quadrupole moment of the binned power spectrum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_Q_bar">
<span class="sig-name descname"><span class="pre">get_Q_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_intensity_per_redshift_mesh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_Q_bar" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the Q_bar value given the weight mesh and the mean field as a function of position.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_S_bar">
<span class="sig-name descname"><span class="pre">get_S_bar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_noise</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_S_bar" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the S_bar value given the weight mesh and the sigma of the Gaussian noise.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_cross_model">
<span class="sig-name descname"><span class="pre">get_cross_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sky_subtraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_cross_model" title="Permalink to this definition"></a></dt>
<dd><p>Calculate and save the power spectrum model for the intensity-galaxy number density cross-power spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sky_subtraction</strong> (<em>bool</em>) – Set to True if you want the sky_subtracted_intensity.
Default: False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_cross_shot_noise">
<span class="sig-name descname"><span class="pre">get_cross_shot_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_cross_shot_noise" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the shot noise of the cross power spectrum
that originates from randomly sampling the number of galaxies
and their luminosity from the first moment of the luminosity function
that includes only the galaxies overlapping in both fields.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_intensity_model">
<span class="sig-name descname"><span class="pre">get_intensity_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sky_subtraction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_3d</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_intensity_model" title="Permalink to this definition"></a></dt>
<dd><p>Calculate and save the power spectrum model for the intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sky_subtraction</strong> (<em>bool</em>) – Set to True if you want the sky_subtracted_intensity.
Default: False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_intensity_shot_noise">
<span class="sig-name descname"><span class="pre">get_intensity_shot_noise</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_intensity_shot_noise" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the shot noise (from randomly sampling the number of galaxies and the
luminosity of each galaxy), which is subject to smoothing from the second moment
of the luminosity function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_model">
<span class="sig-name descname"><span class="pre">get_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_model" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper to calculate and save the model for each tracer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tracer</strong> (<em>str</em>) – Tracer name to get the power spectrum model for.
Options: “intensity”, “n_gal”, “cross”, “sky_subtracted_intensity”, “sky_subtracted_cross”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_models">
<span class="sig-name descname"><span class="pre">get_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_models" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper to calculate and save all specified power spectrum models
here self.run_pk[tracer] is True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_n_gal_model">
<span class="sig-name descname"><span class="pre">get_n_gal_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_n_gal_model" title="Permalink to this definition"></a></dt>
<dd><p>Calculate and save the power spectrum model for the galaxy number density.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.get_observed_volume">
<span class="sig-name descname"><span class="pre">get_observed_volume</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.get_observed_volume" title="Permalink to this definition"></a></dt>
<dd><p>Returns the observed volume given the mask.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.k_N">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_N</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.k_N" title="Permalink to this definition"></a></dt>
<dd><p>Nyquist frequency in [h/Mpc].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.luminosity_function_times_Lsq">
<span class="sig-name descname"><span class="pre">luminosity_function_times_Lsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.luminosity_function_times_Lsq" title="Permalink to this definition"></a></dt>
<dd><p>Luminosity function times L**2</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.mean_intensity_per_redshift_mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_intensity_per_redshift_mesh</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.mean_intensity_per_redshift_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts the 1D mean_intensity_per_redshift array to the 3D mesh (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.mean_ngal_per_redshift_mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_ngal_per_redshift_mesh</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.mean_ngal_per_redshift_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts the 1D mean galaxy number density array to the 3D mesh (cached).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.model_shot_noise">
<span class="sig-name descname"><span class="pre">model_shot_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_real</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.model_shot_noise" title="Permalink to this definition"></a></dt>
<dd><p>Model the shot noise in the intensity and galaxy distributions
by shuffling the cells in the directions perpendicular to the LOS
while keeping the LOS position fixed (to keep directional information
that may exist due to redshift differences).
After shuffling, calculate the power spectrum.
Finally the model shot noise is given by the average of the power spectra
of the shuffled meshes.</p>
<dl class="simple">
<dt>N_real<span class="classifier">int, optional</span></dt><dd><p>Number of realizations of shuffled meshes. Default is 10.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.own_init">
<span class="sig-name descname"><span class="pre">own_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">do_model_shot_noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.own_init" title="Permalink to this definition"></a></dt>
<dd><p>Step in initializing the Power_Spectrum_Model instance.</p>
<dl class="simple">
<dt>do_model_shot_noise<span class="classifier">bool</span></dt><dd><p>Set to True to model the shot noise by shuffling the galaxy positions perpendicular to the LOS.</p>
</dd>
<dt>out_filename<span class="classifier">str</span></dt><dd><p>Output filename for the power spectrum results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.weight_mesh_im">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight_mesh_im</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.weight_mesh_im" title="Permalink to this definition"></a></dt>
<dd><p>just 1/mean_intensity.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Weights for the intensity mesh</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.pk_3d_model.Power_Spectrum_Model.weight_mesh_ngal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">weight_mesh_ngal</span></span><a class="headerlink" href="#simple.pk_3d_model.Power_Spectrum_Model.weight_mesh_ngal" title="Permalink to this definition"></a></dt>
<dd><p>1/(mean n_gal as a function of position).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Weights for the galaxy density mesh</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.pk_3d_model.kaiser_pkmu">
<span class="sig-prename descclassname"><span class="pre">simple.pk_3d_model.</span></span><span class="sig-name descname"><span class="pre">kaiser_pkmu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Plin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_growth</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.pk_3d_model.kaiser_pkmu" title="Permalink to this definition"></a></dt>
<dd><p>Returns the Kaiser linear P(k,mu) in redshift space</p>
<div class="math notranslate nohighlight">
\[P(k,mu) = (1 + f/b_1 \mu^2)^2 b_1^2 P_\mathrm{lin}(k)\]</div>
<p>Copied from nbodykit.</p>
</dd></dl>

</section>
<section id="module-simple.run_lognormal_galaxies">
<span id="simple-run-lognormal-galaxies-module"></span><h2>simple.run_lognormal_galaxies module<a class="headerlink" href="#module-simple.run_lognormal_galaxies" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.calc_Pk">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">calc_Pk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.calc_Pk" title="Permalink to this definition"></a></dt>
<dd><p>Calls calculate_pk/calc_pk_const_los_ngp function of lognormal_galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Number of this realization.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing input parameters for lognormal_galaxies.</p></li>
<li><p><strong>exe</strong> – Executable object used to run the external commands.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.calc_cPk">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">calc_cPk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.calc_cPk" title="Permalink to this definition"></a></dt>
<dd><p>Calls function calculate_cross/calc_cpk_const_los_v2 of lognormal_galaxies to calculate galaxy-matter power spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Number of this realization.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Input parameters for lognormal_galaxies.</p></li>
<li><p><strong>exe</strong> – Executable object used to run the external commands.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.check_dir_im">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">check_dir_im</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.check_dir_im" title="Permalink to this definition"></a></dt>
<dd><p>Creates the necessary directories for saving output files
if they do not already exist.</p>
<dl class="simple">
<dt>params: dict</dt><dd><p>Dictionary containing the parameters passed to lognormal_galaxies,
including “out_dir” specifying the output directory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.executable">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">executable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.executable" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to execute commands</p>
<dl class="py method">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.executable.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.executable.run" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.gen_Poisson">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">gen_Poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.gen_Poisson" title="Permalink to this definition"></a></dt>
<dd><p>Generate galaxy and matter density field and the Poisson-sampled lognormal galaxy catalog
using lognormal_galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> (<em>int</em>) – Number of this realization.</p></li>
<li><p><strong>params</strong> (<em>dict</em>) – Dictionary containing the input parameters for lognormal_galaxies.</p></li>
<li><p><strong>seed1</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>seed2</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>seed3</strong> (<em>int</em>) – Seed.</p></li>
<li><p><strong>exe</strong> – Executable object used to run the external commands.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.gen_inputs">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">gen_inputs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exe</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.gen_inputs" title="Permalink to this definition"></a></dt>
<dd><p>Generates the necessary input files for generate_Poisson.
First, it runs eisensteinhubaonu/compute_pk to calculate the matter power spectrum from the cosmological parameters.
Then it runs compute_xi/compute_xi to calculate the corresponding correlation function.
Then it runs compute_pkG/calc_pkG to calculate the Gaussian power spectrum for the galaxy field.
Then it runs compute_pkG/calc_pkG to calculate the Gaussian power spectrum for the matter field.
Finally it runs compute_pkG/calc_pkG to calculate the Gaussian cross-power spectrum of the galaxy and matter fields.</p>
<dl class="simple">
<dt>params: dict</dt><dd><p>Dictionary containing the parameters for lognormal_galaxies.</p>
</dd>
<dt>exe: object</dt><dd><p>An executable object used to run the external commands.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.wrap_calc_Pk">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">wrap_calc_Pk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.wrap_calc_Pk" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for the function calc_Pk.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.wrap_calc_cPk">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">wrap_calc_cPk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.wrap_calc_cPk" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for function calc_cPk.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.run_lognormal_galaxies.wrap_gen_Poisson">
<span class="sig-prename descclassname"><span class="pre">simple.run_lognormal_galaxies.</span></span><span class="sig-name descname"><span class="pre">wrap_gen_Poisson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.run_lognormal_galaxies.wrap_gen_Poisson" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for gen_Poisson function.</p>
</dd></dl>

</section>
<section id="module-simple.simple">
<span id="simple-simple-module"></span><h2>simple.simple module<a class="headerlink" href="#module-simple.simple" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">simple.simple.</span></span><span class="sig-name descname"><span class="pre">BasicBoxCalculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">box_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">single_redshift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cosmology</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.BasicBoxCalculator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.box_volume">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">box_volume</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.box_volume" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the volume of the simulation box.
Cached like a property self.box_volume.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.delta_redshift">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">delta_redshift</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.delta_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the redshift difference corresponding to the comoving distance of the LOS length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Redshift difference corresponding to the comoving distance of the line-of-sight (LOS) length.
Cached like a property.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If the LOS is not aligned with any of the axes [1,0,0], [0,1,0], or [0,0,1].</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.get_comoving_distance_per_delta_z">
<span class="sig-name descname"><span class="pre">get_comoving_distance_per_delta_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.get_comoving_distance_per_delta_z" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the comoving distance between (z + delta_z) and (z - delta_z).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_z</strong> (<em>float</em>) – Mean redshift of the box: mean_z = (z_min + z_max) / 2.</p></li>
<li><p><strong>delta_z</strong> (<em>float</em>) – Half of the redshift difference: delta_z = (z_max - z_min) / 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Comoving distance between (z + delta_z) and (z - delta_z).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.get_kspec">
<span class="sig-name descname"><span class="pre">get_kspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dohalf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doindep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.get_kspec" title="Permalink to this definition"></a></dt>
<dd><p>Compute the power spectrum in Fourier space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dohalf</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to generate only the half of the Fourier transforms due to symmetry. Default is True.</p></li>
<li><p><strong>doindep</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag indicating whether to calculate only the independent modes of the Fourier transform. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>kspec</strong> (<em>ndarray</em>) – The norm of the wavevector k in the Fourier transform of our meshes.</p></li>
<li><p><strong>muspec</strong> (<em>ndarray</em>) – The corresponding values of mu (cosine of the angle between the LOS and the wavevector k).</p></li>
<li><p><strong>indep</strong> (<em>ndarray (bool)</em>) – Indicates whether the mode is independent or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.get_mesh_positions">
<span class="sig-name descname"><span class="pre">get_mesh_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">voxel_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to_self</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.get_mesh_positions" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array of mesh positions with dimensions (N_mesh, N_mesh, N_mesh, 3),
where mesh_position[i, j, k] is the position vector of the center of cell (i, j, k) in Mpc/h.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>voxel_length</strong> (<em>Quantity array</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Length of each voxel in the three spatial dimensions with length units.</p></li>
<li><p><strong>N_mesh</strong> (<em>array</em><em> (</em><em>3</em><em>,</em><em>)</em>) – Number of cells in each dimension (dimensionless array).</p></li>
<li><p><strong>save_to_self</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save mesh_position to self.mesh_position. Default: True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.k_Nyquist">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">k_Nyquist</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.k_Nyquist" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the Nyquist frequency (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.mean_redshift">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_redshift</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.mean_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the mean of the redshifts of the cells (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.minimum_distance">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimum_distance</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.minimum_distance" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the minimum distance of a cell within the mesh (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.redshift_mesh_axis">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">redshift_mesh_axis</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.redshift_mesh_axis" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the redshift coordinates along the LOS axis (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.BasicBoxCalculator.voxel_volume">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">voxel_volume</span></span><a class="headerlink" href="#simple.simple.BasicBoxCalculator.voxel_volume" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the volume of a voxel.
Cached like a property self.voxel_volume.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">simple.simple.</span></span><span class="sig-name descname"><span class="pre">LognormalIntensityMock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_dict</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#simple.simple.BasicBoxCalculator" title="simple.simple.BasicBoxCalculator"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasicBoxCalculator</span></code></a></p>
<p>The LognormalIntensityMock class takes cosmological and survey parameters as input
and produces a intensity and galaxy density meshes from a lognormal galaxy catalog.
It can apply a selection function, smoothing, masks, add noise, and model the sky subtraction.
Finally, it can calculate the power spectra.</p>
<p>The following parameter list will contain the input parameters in the input_dict.
input_dict can be a dictionary or string.
As a dictionary, it should contain the following input parameters.
If it is a string, it should be the filename of a yaml file version of the dictionary.</p>
<p>Strings as arguments in the dictionary or yaml file can be evaluated in python, e.g. ‘10 * u.Mpc’.
Here, ‘u’ is the imported name for ‘astropy.units’.
Other possible packages are numpy (‘np’) and astropy.constants (‘const’).
If a string contains ‘cosmo’, it will be converted to the class’ astropy cosmology.
Therefore expressions such as ‘cosmo.h’ can be evaluated self-consistently.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to print lots of output.
If False, it will only print errors.
Default: True.</p></li>
<li><p><strong>cosmology</strong> (<em>string</em><em>, </em><em>dict</em><em>, or </em><em>astropy cosmology object</em>) – If astropy cosmology object, it will directly use this.
If string, it can either be a named cosmology in astropy.cosmology
(see <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/index.html#built-in-cosmologies">https://docs.astropy.org/en/stable/cosmology/index.html#built-in-cosmologies</a>)
or the name of an ecsv-format file generated by saving an astropy.cosmology object
(see <a class="reference external" href="https://docs.astropy.org/en/stable/cosmology/io.html#cosmology-io">https://docs.astropy.org/en/stable/cosmology/io.html#cosmology-io</a>).
If dict, it will attempt to initiate an astropy.cosmology.FlatwCDM object from the dict
(see <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM">https://docs.astropy.org/en/stable/api/astropy.cosmology.FlatwCDM.html#astropy.cosmology.FlatwCDM</a>).</p></li>
<li><p><strong>luminosity_function</strong> (<em>string</em><em> or </em><em>function</em>) – If function, it should take the luminosity as an input (in units of luminosity_unit, but as a float)
and return dn/dL as output (in units of 1/luminosity_unit * 1/Mpc**3).
If string, it should be the name of the file that contains a table (csv format readable by astropy.table)
where ‘L’ is the column containing the luminosity (in units of luminosity_unit, but as a float)
and ‘dn/dL’ is the column containing the corresponding dn/dL (in units of 1/luminosity_unit * 1/Mpc**3).
Then the class will interpolate between the values and extrapolate at the borders.</p></li>
<li><p><strong>luminosity_unit</strong> (<em>astropy quantity</em>) – This is the unit of the luminosity in the luminosity function.</p></li>
<li><p><strong>Lmin</strong> (<em>astropy quantity</em>) – This is the minimum luminosity to consider for the luminosity function.
This is necesssary to get a finite number of galaxies to generate.</p></li>
<li><p><strong>Lmax</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – This is the maximum luminosity to consider for the luminosity function.
Default: infinity.</p></li>
<li><p><strong>input_pk_filename</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Name of the file containing a tabulated input matter power spectrum.
This power spectrum will be used to generate the lognormal galaxy catalog.
The file should be ascii-formatted with</p>
<blockquote>
<div><p>first column: wavenumber in units of [h/Mpc],
second column:  matter power spectrum in units of [Mpc^3/h^3].</p>
</div></blockquote>
<p>The first column should not contain names for the columns (should be read by lognormal_galaxies code).
Default: Use the file generated by lognormal_galaxies from the input cosmological parameters
and the Eisenstein &amp; Hu fitting function (see Agrawal et al. 2017 arxiv:1706.09195).</p>
</p></li>
<li><p><strong>f_growth_filename</strong> (<em>string</em><em>, </em><em>optional</em>) – <p>Name of the file containing a tabulated logarithmic growth function.
This will be used to generate the lognormal galaxy catalog
(lognormal_galaxies: “logarithmic growth rate fnu for massive (massless)
neutrinos which varies (does not vary) as a function of k”).
The file should be ascii formatted with</p>
<blockquote>
<div><p>1st column: wavenumber [h Mpc^-1],
2nd column: fnu.</p>
</div></blockquote>
<p>Default: Use the file generated by lognormal_galaxies from
the input cosmological parameters (see Agrawal et al. 2017 arxiv:1706.09195).</p>
</p></li>
<li><p><strong>redshift</strong> (<em>float</em>) – Central redshift of the box so that z_max - redshift = redshift - z_min
where z_min and z_max are the minimum and maximum redshift of the box, respectively.
Will be assigned to the entire box if single_redshift == True.</p></li>
<li><p><strong>bias</strong> (<em>float</em>) – Galaxy bias.</p></li>
<li><p><strong>box_size</strong> (<em>astropy quantity array</em>) – This should be a list or array containing the three box side lengths
in the dimension of length using astropy.units.
It will be converted to units of Mpc/h.</p></li>
<li><p><strong>N_mesh</strong> (<em>array-like</em><em>, </em><em>optional</em>) – <dl class="simple">
<dt>List containing the mesh size (3 numbers) used to generate the galaxy catalog,</dt><dd><p>meshes, and Fourier transforms.</p>
</dd>
</dl>
<p>This is optional if voxel_length is given instead.</p>
</p></li>
<li><p><strong>voxel_length</strong> (<em>astropy quantity array</em><em>, </em><em>optional</em>) – List containing the side lengths of the voxels (3 astropy quantities).
It will be slightly adjusted to make sure than N_mesh is an integer.
This is optional if N_mesh is given and will be ignored if N_mesh is given.</p></li>
<li><p><strong>single_redshift</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether the ‘redshift’ parameter should be assigned to the entire box.
If False, the redshift will evolve along the line of sight (LOS).
Default: False.</p></li>
<li><p><strong>RSD</strong> (<em>bool</em>) – Flag stating whether to calculate the power spectra in redshift space.
This is only important when using the run() function, which runs everything automatically.
If this class is used in a modular way, you can choose in each function.</p></li>
<li><p><strong>min_flux</strong> (<em>astropy quantity</em><em>, </em><em>function</em><em>, or </em><em>string</em><em>, </em><em>optional</em>) – <p>If it is an astropy quantity, it denotes the minimum flux above which a galaxy is detected.
If it is a function, it should take the redshift as input and should output the minimum flux
(as an astropy quantity in flux units).
If it is a string, it should be the name of the file</p>
<blockquote>
<div><ul>
<li><dl>
<dt>either containing a table in ecsv format readable by astropy.table with</dt><dd><ul class="simple">
<li><p>’redshift’ column: redshift</p></li>
<li><p>’min_flux’ column: min_flux at that redshift,</p></li>
<li><p>unit of ‘min_flux’: unit of the ‘min_flux’ column (automatic if saved using astropy.table).</p></li>
</ul>
<p>In this case, it will interpolate between redshifts (in case a redshift is out of bounds,
the border values are used.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>or in hdf5 format with</dt><dd><ul class="simple">
<li><p>ff[“min_flux”] : min_flux mesh with the same shape as N_mesh</p></li>
<li><p>ff[“min_flux”].attrs[“unit”] should be the string of the astropy unit (e.g. “erg / (cm2 s)”).</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Default: None. Then all galaxies are detected unless ‘limit_ngal’ is given.</p>
</p></li>
<li><p><strong>limit_ngal</strong> (<em>astropy quantity</em><em>, </em><em>function</em><em>, or </em><em>string</em><em>, </em><em>optional</em>) – <p>If it is an astropy quantity, it is the desired galaxy number density (in inverse volume dimension)
of the detected galaxies. From this, a minimum flux will be calculated for the selection function.
If it is a function, it should take the redshift as input and
should output the desired galaxy number density (as an astropy quantity in inverse volume dimensions).
If it is a string, it should be the name of the file
containing a table in ecsv format readable by astropy.table with</p>
<blockquote>
<div><ul>
<li><p>’redshift’ column: redshift,</p></li>
<li><p>’limit_ngal’ column: limit_ngal at that redshift,</p></li>
<li><p>unit of ‘limit_ngal’: unit of the ‘limit_ngal’ column (automatic if saved using astropy.table).</p></li>
</ul>
</div></blockquote>
<p>In this case it will interpolate between redshifts (in case a redshift is out of bounds,
the border values are used.)
Default: None. Then all galaxies are detected unless min_flux is given.
Will be ignored if min_flux is given.</p>
</p></li>
<li><p><strong>galaxy_selection</strong> (<em>dict</em>) – Dictionary containing the set of galaxies to be included in the intensity and n_gal meshes.
The keys must contain ‘n_gal’ and ‘intensity’.
Options for the values are ‘all’, ‘detected’, and ‘undetected’.</p></li>
<li><p><strong>sigma_noise</strong> (<em>astropy quantity</em><em>, </em><em>nd-array of astropy quantities</em><em>, </em><em>function</em><em>, or </em><em>string</em><em>, </em><em>optional</em>) – <p>If it is an astropy quantity, it denotes the sigma of the Gaussian noise in intensity units.
If it is an array of astropy quantities, it denotes the sigma of the Gaussian noise in intensity units
at that position in the array.
If it is a function, it should take the redshift as input and should output the
sigma_noise at that redshift (as an astropy quantity in intensity units).
If it is a string, it can be either</p>
<blockquote>
<div><ol class="arabic">
<li><dl>
<dt>the name of the file in an ecsv format readable by astropy.table, containing</dt><dd><ul>
<li><p>’redshift’ column: redshift,</p></li>
<li><p>’sigma_noise’ column: sigma_noise at that redshift,</p></li>
<li><p>unit of ‘sigma_noise’ (automatic if saved using astropy.table)</p></li>
</ul>
<p>Then it will be interpolated between redshifts (in case a redshift is out of bounds,
the border values are used.)</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>or the name of the hdf5 file containing the sigma_noise mesh (same shape as N_mesh)</dt><dd><p>under the name ‘sigma_noise’ with the unit as a string under ff[‘sigma_noise’].attrs[‘unit’].</p>
</dd>
</dl>
</li>
</ol>
</div></blockquote>
<p>Default: None. Then the noise is zero.</p>
</p></li>
<li><p><strong>lambda_restframe</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Rest-frame wavelength in length units.
If lambda_restframe is given, the intensity will be specific intensity dI/dlambda.
Optional if ‘nu_restframe’ is given.</p></li>
<li><p><strong>nu_restframe</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Rest-frame frequency in inverse time units.
If lambda_restframe is given, the intensity will be specific intensity dI/dnu.
Optional if ‘lambda_restframe’ is given.</p></li>
<li><p><strong>brightness_temperature</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to calculate everything in temperature units
instead of specific intensity units.</p></li>
<li><p><strong>do_spectral_smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to smooth along the spectral dimension.
If ‘do_spectral_smooth’ is True, either ‘dlambda’ or ‘dnu’ must be given,
corresponding to whether lambda_restframe or nu_restframe are given.
Default: False.</p></li>
<li><p><strong>dlambda</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Smoothing wavelength (in wavelength units) along the spectral direction.
If ‘do_spectral_tophat_smooth’ is True, it is the size of the 1d top-hat.
Otherwise, it is the Gaussian sigma for a Gaussian smoothing kernel.
This will be evaluated at the central redshift (‘redshift’ parameter) of the box for smoothing.
Must be given if ‘do_spectral_smooth’ is True and ‘lambda_restframe’ is given.
Will be ignored otherwise.</p></li>
<li><p><strong>dnu</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Smoothing frequency (in frequency units) along the spectral direction.
If ‘do_spectral_tophat_smooth’ is True, it is the size of the 1d top-hat.
Otherwise, it is the Gaussian sigma for a Gaussian smoothing kernel.
This will be evaluated at the central redshift (‘redshift’ parameter) of the box for smoothing.
Must be given if ‘do_spectral_smooth’ is True and ‘nu_restframe’ is given.
Will be ignored otherwise.</p></li>
<li><p><strong>do_spectral_tophat_smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to use a 1d top-hat smoothing kernel in the angular direction.
If False, it will use a Gaussian kernel instead.
Default: False.</p></li>
<li><p><strong>do_angular_smooth</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to smooth in the directions perpendicular to the LOS.
This will be a Gaussian smoothing kernel.
If True, ‘sigma_beam’ must be given.
Default: False.</p></li>
<li><p><strong>sigma_beam</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Gaussian sigma for the Gaussian smoothing kernel perpendicular to the LOS, in angle units.
This will be evaluated at the central redshift (‘redshift’ parameter) of the box for smoothing.
Must be given if ‘do_angular_smooth’ is True.
Will be ignored otherwise.</p></li>
<li><p><strong>footprint_radius</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Radius of a circular focal plane in angle units.
This is necessary if you want to perform a sky subtraction and will be ignored otherwise.
Default: None</p></li>
<li><p><strong>seed_lognormal</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for the (random) generation of the lognormal galaxy catalog and the noise.
It it is the same twice, you should get the same results.
Default: None</p></li>
<li><p><strong>run_pk</strong> (<em>dictionary</em><em>, </em><em>optional</em>) – Dictionary stating which power spectra to calculate.
Keys can include [“intensity”, “n_gal”, “cross”, “sky_subtracted_intensity”, “sky_subtracted_cross”]
and the values are either True or False.
Default for each key (if not given): False.</p></li>
<li><p><strong>dk</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Size of the linearly spaced wavenumber bins to calculate the power spectra (inverse length units).
Default: 2 pi / minimum box size.</p></li>
<li><p><strong>kmin</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Minimum k of the linearly spaced wavenumber bins to calculate the power spectra (inverse length units).
Default: 0.</p></li>
<li><p><strong>kmax</strong> (<em>astropy quantity</em><em>, </em><em>optional</em>) – Maximum k of the linearly spaced wavenumber bins to calculate the power spectra (inverse length units).
Default: minimum Nyquist frequency.</p></li>
<li><p><strong>obs_mask</strong> (<em>ndarray</em><em> (</em><em>3</em><em>,</em><em>) or </em><em>string</em>) – If it is an ndarray, it should contain the mask (or weights) as floats
and should have the same shape as given by N_mesh.
If it is a string, it should be the name of the hdf5 file containing the
mask array under the name ‘mask’.
Default: None (then the mask will be generated as ones).</p></li>
<li><p><strong>calc_pk_lognormal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag stating whether to have the galaxy power spectrum calculated by lognormal_galaxies.
In this case, it will output the galaxy power spectrum of all galaxies in a file
as described in <a class="reference external" href="https://bitbucket.org/komatsu5147/lognormal_galaxies/src/master/">https://bitbucket.org/komatsu5147/lognormal_galaxies/src/master/</a>.
Default: False.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The redshift direction is chosen to be the first axis
such that the smallest index is closest to the observer.</p>
<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.N_gal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N_gal</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.N_gal" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the number of all galaxies (no selection function) from self.n_bar_gal.
Cached like a property self.N_gal</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.N_gal_detected">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">N_gal_detected</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.N_gal_detected" title="Permalink to this definition"></a></dt>
<dd><p>Outputs the number of detected galaxies in the galaxy catalog (no mask).
Cached like a property self.N_gal_detected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.Pk_multipoles">
<span class="sig-name descname"><span class="pre">Pk_multipoles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tracer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.Pk_multipoles" title="Permalink to this definition"></a></dt>
<dd><p>Compute the power spectrum monopole and quadrupole of the map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tracer</strong> (<em>str</em><em>, </em><em>optional</em>) – Which power spectrum to compute.
Options: ‘intensity’, ‘n_gal’, ‘cross’, ‘sky_subtracted_intensity’, ‘sky_subtracted_cross’.
Default: ‘intensity’.</p></li>
<li><p><strong>save</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to save the computed power spectrum to a file. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_k</strong> (<em>array_like</em>) – Array of mean wavenumbers.</p></li>
<li><p><strong>monopole</strong> (<em>array_like</em>) – Array of monopole power spectrum values.</p></li>
<li><p><strong>quadrupole</strong> (<em>array_like</em>) – Array of quadrupole power spectrum values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.apply_selection_function">
<span class="sig-name descname"><span class="pre">apply_selection_function</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.apply_selection_function" title="Permalink to this definition"></a></dt>
<dd><p>Assigns whether each galaxy was detected or not given the flux limit (min_flux)
of the observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_flux</strong> (<em>astropy quantity</em><em>, </em><em>nd-array of floastropy quantities</em><em>, or </em><em>function of redshift</em><em>, </em><em>optional</em>) – Flux limit of the (mock) observation above which galaxies are detected.
If a function, it represents the flux limit as a function of redshift.
Units of flux (erg/s/cm**2) required.
Either <cite>min_flux</cite> or <cite>limit_ngal</cite> must be provided.</p></li>
<li><p><strong>limit_ngal</strong> (<em>float</em><em> or </em><em>function of redshift</em><em>, </em><em>optional</em>) – Given number of galaxies per unit comoving volume above which galaxies are detected.
If a function, it represents the number density limit as a function of redshift.
Either <cite>min_flux</cite> or <cite>limit_ngal</cite> must be provided.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – No min_flux or limit_ngal given.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function requires the galaxies to have assigned fluxes. If the fluxes are not assigned, they will be computed using the <cite>assign_flux()</cite> method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.assign_flux">
<span class="sig-name descname"><span class="pre">assign_flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">luminosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'luminosity'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.assign_flux" title="Permalink to this definition"></a></dt>
<dd><p>Converts luminosity to flux in the galaxy catalog.
Accounts for cosmological effects, not for peculiar velocities.
Adds the column ‘flux’ to self.cat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>luminosity</strong> (<em>str</em><em>, </em><em>optional</em>) – Key name of the luminosity column in the catalog, by default “luminosity”.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function requires the galaxies to have assigned redshifts.
If the redshifts are not assigned, they will be assigned using either a single redshift or redshift along the LOS.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.assign_luminosity">
<span class="sig-name descname"><span class="pre">assign_luminosity</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.assign_luminosity" title="Permalink to this definition"></a></dt>
<dd><p>Randomly assigns luminosities to the galaxies following the luminosity function.
Adds the column ‘luminosity’ to self.cat.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function requires a lognormal galaxy catalog.
If the catalog does not exist, it will generate it using lognormal simulations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.assign_redshift_along_axis">
<span class="sig-name descname"><span class="pre">assign_redshift_along_axis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.assign_redshift_along_axis" title="Permalink to this definition"></a></dt>
<dd><p>Assigns redshift along the line-of-sight (LOS) axis
(x, y, or z) given the mean/middle redshift.
Also assigns the redshift-space distortion
(RSD) redshift and inferred positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the LOS is not aligned with any of the axes [1,0,0], [0,1,0], or [0,0,1].</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function requires a lognormal galaxy catalog. If the catalog does not exist, it will generate it using lognormal simulations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.assign_single_redshift">
<span class="sig-name descname"><span class="pre">assign_single_redshift</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.assign_single_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Assigns a single redshift to the entire box.
Adds the columns ‘cosmo_redshift’, ‘RSD_redshift’,
‘RSD_redshift_factor’, ‘RSD_Position’ to self.cat.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function requires a lognormal galaxy catalog.
If the catalog does not exist, it will generate it using lognormal simulations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.bin_scipy">
<span class="sig-name descname"><span class="pre">bin_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_nmodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.bin_scipy" title="Permalink to this definition"></a></dt>
<dd><p>Perform binning of the power spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkspec</strong> (<em>ndarray</em>) – The power spectrum mesh to be binned.</p></li>
<li><p><strong>return_nmodes</strong> (<em>bool</em>) – Set to true if you want to have the number of modes in each bin returned.
Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_k</strong> (<em>ndarray</em>) – The mean wavenumber in each bin.</p></li>
<li><p><strong>monopole</strong> (<em>ndarray</em>) – The monopole component of the power spectrum.</p></li>
<li><p><strong>quadrupole</strong> (<em>ndarray</em>) – The quadrupole component of the power spectrum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.copy_info">
<span class="sig-name descname"><span class="pre">copy_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.copy_info" title="Permalink to this definition"></a></dt>
<dd><p>Initiates a new LognormalIntensityMock instance with the same input parameters as the original one.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A new instance of LognormalIntensityMock with the same input parameters as the original.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#simple.simple.LognormalIntensityMock" title="simple.simple.LognormalIntensityMock">LognormalIntensityMock</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.downsample_all_meshes">
<span class="sig-name descname"><span class="pre">downsample_all_meshes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_N_mesh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.downsample_all_meshes" title="Permalink to this definition"></a></dt>
<dd><p>Downsamples all meshes to a new grid resolution using NGP:
n_gal_mesh, intensity_mesh, obs_mask, sky_intensity_mesh, noise_mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>new_N_mesh</strong> (<em>list of int</em><em> (</em><em>len 3</em><em>)</em>) – The new grid resolution for downsampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_meshes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['intensity_mesh',</span> <span class="pre">'noise_mesh',</span> <span class="pre">'n_gal_mesh',</span> <span class="pre">'obs_mask']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Initialize a LognormalIntensityMock instance from a saved file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The filename of the saved file.</p></li>
<li><p><strong>catalog_filename</strong> (<em>str</em><em>, </em><em>optional</em>) – The filename of the galaxy catalog to be read. Default is None.</p></li>
<li><p><strong>only_params</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, only the parameters are loaded and not the meshes. Default is False.</p></li>
<li><p><strong>only_meshes</strong> (<em>list of str</em><em>, </em><em>optional</em>) – The list of specific meshes to be loaded. Default is [“intensity_mesh”, “noise_mesh”, “n_gal_mesh”, “obs_mask”].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new instance of LognormalIntensityMock initialized from the saved file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#simple.simple.LognormalIntensityMock" title="simple.simple.LognormalIntensityMock">LognormalIntensityMock</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.get_comoving_distance_per_delta_z">
<span class="sig-name descname"><span class="pre">get_comoving_distance_per_delta_z</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_z</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.get_comoving_distance_per_delta_z" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the comoving distance between (z + delta_z) and (z - delta_z).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_z</strong> (<em>float</em>) – Mean redshift of the box: mean_z = (z_min + z_max) / 2.</p></li>
<li><p><strong>delta_z</strong> (<em>float</em>) – Half of the redshift difference: delta_z = (z_max - z_min) / 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Comoving distance between (z + delta_z) and (z - delta_z).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.get_intensity_noise_cube">
<span class="sig-name descname"><span class="pre">get_intensity_noise_cube</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.get_intensity_noise_cube" title="Permalink to this definition"></a></dt>
<dd><p>Generate a mock intensity noise cube following a Gaussian distribution with an input sigma.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>noise_mesh</strong> – The generated intensity noise cube in units of mean intensity.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If sigma_noise is not provided, a zero noise cube is returned.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.get_sky_background">
<span class="sig-name descname"><span class="pre">get_sky_background</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">footprint_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.get_sky_background" title="Permalink to this definition"></a></dt>
<dd><p>Compute the contribution of the intensity map to the measured sky background.
It achieves this by smoothing the intensity mesh in the angular directions
using a top-hat filter of the specified angular footprint size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>footprint_angle</strong> (<em>astropy.u.Quantity</em><em> (</em><em>scalar</em><em>)</em>) – Angular footprint size as an angular astropy Quantity in angle units.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sky_intensity_mesh</strong> – The computed sky background intensity mesh in units of mean intensity.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.input_power_spectrum">
<span class="sig-name descname"><span class="pre">input_power_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.input_power_spectrum" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the power spectrum corresponding to the given wavenumber values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>k</strong> (<em>array-like</em>) – Wavenumber values in units of [h / Mpc].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Power spectrum values in units of [Mpc^3/h^3].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.load_lognormal_catalog_cpp">
<span class="sig-name descname"><span class="pre">load_lognormal_catalog_cpp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_bin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.load_lognormal_catalog_cpp" title="Permalink to this definition"></a></dt>
<dd><p>Loads the lognormal catalog from a binary file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_filename</strong> (<em>str</em>) – Path to the binary file containing the lognormal galaxy catalog (output from lognormal_galaxies).</p></li>
<li><p><strong>delete_bin</strong> (<em>bool</em>) – Set to False if you want to keep the binary file.
Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>AssertionError</strong> – If the number of galaxies in the lognormal catalog does not match the number of positions in the loaded catalog.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.log10_luminosity_function">
<span class="sig-name descname"><span class="pre">log10_luminosity_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log10_L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.log10_luminosity_function" title="Permalink to this definition"></a></dt>
<dd><p>Log_10 of the luminosity function.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.lognormal_bin_filename">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lognormal_bin_filename</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.lognormal_bin_filename" title="Permalink to this definition"></a></dt>
<dd><p>Automatically generates the filename for the binary output file of lognormal_galaxies galaxy catalog.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.luminosity_function_times_L">
<span class="sig-name descname"><span class="pre">luminosity_function_times_L</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.luminosity_function_times_L" title="Permalink to this definition"></a></dt>
<dd><p>dn/dL * L</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.mean_intensity">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_intensity</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.mean_intensity" title="Permalink to this definition"></a></dt>
<dd><p>Returns the mean intensity of the mesh in units of mean intensity.
As soon as it is calculated once, it is saved.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.mean_intensity_per_redshift">
<span class="sig-name descname"><span class="pre">mean_intensity_per_redshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redshifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intensity'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.mean_intensity_per_redshift" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the mean intensity or the mean galaxy number density that we would expect
at a given redshift of a given galaxy population (either all or detected/undetected galaxies).
We use the integrals
$$bar{rho}_L(z) &amp;= int_{<a href="#id7"><span class="problematic" id="id8">L_</span></a>mathrm{min}}^{<a href="#id9"><span class="problematic" id="id10">L_</span></a>mathrm{max}} dL, frac{mathrm{d}n}{mathrm{d}L} L$$
$bar{I}_lambda(z) = frac{c bar{rho}_L(z)}{4 pi lambda_0 H(z)}$
and
$bar{n}_mathrm{gal}(z) &amp;= int_{<a href="#id11"><span class="problematic" id="id12">L_</span></a>mathrm{min}}^{<a href="#id13"><span class="problematic" id="id14">L_</span></a>mathrm{max}} dL, frac{mathrm{d}n}{mathrm{d}L}$,
where
Lmin = self.Lmin for all galaxies or undetected galaxies</p>
<blockquote>
<div><p>self.min_flux(z) * 4 * np.pi * D_L**2 for detected galaxies</p>
</div></blockquote>
<p>and
Lmax = self.Lmax for all galaxies or detected galaxies</p>
<blockquote>
<div><p>self.min_flux(z) * 4 * np.pi * D_L**2 for undetected galaxies.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redshifts</strong> (<em>array</em><em> (</em><em>n</em><em>,</em><em>)</em>) – List/array of redshifts to be computed.</p></li>
<li><p><strong>galaxy_selection</strong> (<em>str</em>) – Which galaxies to use: ‘all’, ‘detected’, or ‘undetected’. Default: ‘all’.</p></li>
<li><p><strong>tracer</strong> (<em>str</em>) – Whether to calculate the mean intensity (‘intensity’) or mean galaxy number density (‘n_gal’).
Default: ‘intensity’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>mean_intensity_per_redshift</strong> – List/array of the mean intensity per redshift (if tracer==’intensity’) or mean galaxy number density
per redshift (if tracer==’n_gal’). Same shape as input redshifts array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Quantity array (n,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.mean_intensity_per_redshift_mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_intensity_per_redshift_mesh</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.mean_intensity_per_redshift_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts the 1D mean_intensity_per_redshift array to the 3D mesh (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.mean_ngal_per_redshift_mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mean_ngal_per_redshift_mesh</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.mean_ngal_per_redshift_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Broadcasts the 1D mean_n_gal_per_redshift array to the 3D mesh (cached).</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.n_bar_gal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_bar_gal</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.n_bar_gal" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the mean galaxy number density by
integrating over the luminosity function from Lmin to Lmax.
It does not take the selection function into account.
Make sure that the luminosity function output is in units of
luminosity_function: dn/dL
integral: $int dn/dL dL = n_bar_gal$ in units of 1/Mpc**3
IMPORTANT: The luminosity function input has to be in units of [Mpc^-3 luminosity_unit^-1]
so that int dn/dl dL is in units of [Mpc^-3].</p>
<p>Cached like a property self.n_bar_gal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The expected mean galaxy number density in units of 1/Mpc**3,
not taking into account the selection function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantity</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.n_bar_gal_mesh">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_bar_gal_mesh</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.n_bar_gal_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the mean galaxy number density from the mesh self.n_gal_mesh.
Cached like a property self.n_bar_gal_mesh.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.n_gal_detected">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_gal_detected</span></span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.n_gal_detected" title="Permalink to this definition"></a></dt>
<dd><p>Outputs the number density of detected galaxies in the galaxy catalog (no mask).
Cached like a property self.n_gal_detected.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.paint_galaxy_mesh">
<span class="sig-name descname"><span class="pre">paint_galaxy_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RSD_Position'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.paint_galaxy_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the galaxy number density mesh based on the specified position of galaxies.
The parameter self.galaxy_selection_function[‘n_gal’] decides whether to use
detected, undetected, or all galaxies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>position</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name in the catalog representing the position of galaxies.
Options: “RSD_Position” (redshift space), “Position” (real space)
Default: “RSD_Position”.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>field</strong> – The generated galaxy number density mesh.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.paint_intensity_mesh">
<span class="sig-name descname"><span class="pre">paint_intensity_mesh</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">position</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'RSD_Position'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cosmo_redshift'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tracer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'intensity'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">luminosity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'luminosity'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.paint_intensity_mesh" title="Permalink to this definition"></a></dt>
<dd><p>Generates the mock intensity map obtained from Cartesian coordinates.
It does not include noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>position</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name in the catalog representing the position of galaxies.
Options: “RSD_Position” (redshift space), “Position” (real space).
Default: “RSD_Position”.</p></li>
<li><p><strong>redshift</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name in the catalog representing the redshift of galaxies.
This is used to calculate the intensity and irrelevant for tracer “n_gal”.
Options: “cosmo_redshift” (without RSD), “RSD_redshift” (which RSD).
Default: “cosmo_redshift”.</p></li>
<li><p><strong>tracer</strong> (<em>str</em><em>, </em><em>optional</em>) – The tracer to generate the intensity map for.
Options: “intensity”, “n_gal”.
Default: “intensity”.</p></li>
<li><p><strong>luminosity</strong> (<em>str</em><em>, </em><em>optional</em>) – The column name in the catalog representing the luminosity of galaxies.
Options: “luminosity”.
Default: “luminosity”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>field</strong> – The generated intensity map.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If <cite>tracer</cite> argument is not one of the allowed options.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.prepare_k_values">
<span class="sig-name descname"><span class="pre">prepare_k_values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.prepare_k_values" title="Permalink to this definition"></a></dt>
<dd><p>Prepares the dimensionless k values for the power spectrum calculations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.read_galaxy_catalog">
<span class="sig-name descname"><span class="pre">read_galaxy_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">catalog_filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.read_galaxy_catalog" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the galaxy catalog from a specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>catalog_filename</strong> (<em>str</em>) – The filename of the galaxy catalog file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the galaxy catalog data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_lognormal</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_meshes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.run" title="Permalink to this definition"></a></dt>
<dd><p>Runs the entire simulation and analysis pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skip_lognormal</strong> (<em>bool</em><em>, </em><em>optional</em>) – Skip the lognormal simulation and use a pre-generated catalog. Default: False.</p></li>
<li><p><strong>save_meshes</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the generated LognormalIntensityMock instance to a file and the galaxy catalog to another file. Default: False.</p></li>
<li><p><strong>save_results</strong> (<em>bool</em><em>, </em><em>optional</em>) – Save the computed power spectra to a file. Default: True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function performs all the necessary steps to run the simulation and analyze the results.
It includes</p>
<blockquote>
<div><ul class="simple">
<li><p>the lognormal simulation,</p></li>
<li><p>catalog loading,</p></li>
<li><p>redshift assignment,</p></li>
<li><p>luminosity and flux assignment,</p></li>
<li><p>selection function application,</p></li>
<li><p>painting intensity and galaxy meshes,</p></li>
<li><p>and computing power spectra.</p></li>
</ul>
</div></blockquote>
<p>If <cite>skip_lognormal</cite> is False (default), the lognormal simulation and catalog loading will be performed.
Then, redshift assignment, luminosity assignment, flux assignment, and selection function application will be executed.</p>
<p>The position variable used for painting the intensity and galaxy meshes depends on the RSD (Redshift-Space Distortion) setting self.RSD.
If RSD is enabled, “RSD_Position” is used, and if RSD is disabled, “Position” is used.</p>
<p>The intensity and galaxy meshes will be painted if the corresponding power spectra are enabled in the self.run_pk setting.</p>
<p>If <cite>save_meshes</cite> is True, the generated intensity and galaxy meshes will be saved to file.</p>
<p>If <cite>save_results</cite> is True (default), the computed power spectra will be saved to file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.run_lognormal_simulation_cpp">
<span class="sig-name descname"><span class="pre">run_lognormal_simulation_cpp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.run_lognormal_simulation_cpp" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the power spectrum from input cosmology
and runs lognormal simulation in lognormal_galaxies.
Calculates the RSD position given the LOS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None.</strong> – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.save_galaxy_catalog">
<span class="sig-name descname"><span class="pre">save_galaxy_catalog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Position',</span> <span class="pre">'Velocity']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'{}_catalog.h5'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">galaxy_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'detected'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.save_galaxy_catalog" title="Permalink to this definition"></a></dt>
<dd><p>Saves the galaxy catalog, either all galaxies or only detected or undetected galaxies,
as an h5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cat</strong> (<em>LognormalCatalog object</em><em>, </em><em>optional</em>) – Which catalog to save. Default: None. If None, use self.cat.</p></li>
<li><p><strong>keys</strong> (<em>list of strings</em><em>, </em><em>optional</em>) – Which columns to save of the catalog. Options: Position, RSD_Position, Velocity, VelocityOffset,
cosmo_redshift, RSD_redshift, luminosity, flux, detected.
Default: Position and Velocity.</p></li>
<li><p><strong>filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Name of the output catalog file. If it contains a {}, it will be filled with the galaxy_selection argument.
Default: ‘{}_galaxies.h5’.</p></li>
<li><p><strong>galaxy_selection</strong> (<em>str</em><em>, </em><em>optional</em>) – Whether to save all, detected, or undetected galaxies. Options: ‘all’, ‘detected’, ‘undetected’.
Default: ‘detected’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If galaxy_selection is not ‘all’, ‘detected’, or ‘undetected’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function saves the specified columns of the galaxy catalog as an h5 file.
The saved file can be opened using h5py and converted into an astropy Table:
&gt;&gt;&gt; import h5py
&gt;&gt;&gt; from astropy.table import Table
&gt;&gt;&gt; with h5py.File(filename, ‘r’) as F:
&gt;&gt;&gt;     tab = Table(F)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.save_to_file">
<span class="sig-name descname"><span class="pre">save_to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">catalog_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.save_to_file" title="Permalink to this definition"></a></dt>
<dd><p>Saves the instance and its attributes to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – The filename of the file to save the instance to.</p></li>
<li><p><strong>catalog_filename</strong> (<em>str</em><em>, </em><em>optional</em>) – The filename of the galaxy catalog file to save (default is None).
If None, it does not save the galaxy catalog.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.sigma_par">
<span class="sig-name descname"><span class="pre">sigma_par</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.sigma_par" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the comoving distance corresponding to the
LOS smoothing length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma_par</strong> – Comoving distance corresponding to the
LOS smoothing length.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantity</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the comoving distance corresponding to the smoothing length along the line-of-sight (LOS)
direction. The calculated value depends on the specified rest frame wavelength (lambda_restframe)
or frequency (nu_restframe), the LOS direction, and the cosmological parameters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="simple.simple.LognormalIntensityMock.sigma_perp">
<span class="sig-name descname"><span class="pre">sigma_perp</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.LognormalIntensityMock.sigma_perp" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the comoving distance corresponding to the angular smoothing length.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sigma_perp</strong> – Comoving distance corresponding to the angular smoothing length.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Quantity</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function calculates the comoving distance corresponding to the smoothing length perpendicular to the line-of-sight (LOS)
direction. The calculated value depends on the specified redshift, angular diameter distance, angular smoothing length,
and the cosmological parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.simple.angular_tophat_filter">
<span class="sig-prename descclassname"><span class="pre">simple.simple.</span></span><span class="sig-name descname"><span class="pre">angular_tophat_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.angular_tophat_filter" title="Permalink to this definition"></a></dt>
<dd><p>Top-hat filter for k_perp.
Applies to an pmesh mesh object as a regular filter.</p>
<dl class="simple">
<dt>Uses globally defined variables:</dt><dd><p>size_perp - ‘angular’ size of the top-hat filter in the flat sky approximation</p>
</dd>
<dt>Usage:</dt><dd><p>mesh.apply(angular_tophat_filter, mode=’complex’, kind=’wavenumber’)</p>
</dd>
</dl>
<p>NOTES:
k[0] <a href="#id1"><span class="problematic" id="id2">*</span></a>= modifies the next iteration in the loop.
Coordinates are fixed except for the k[1] which are
the coordinate that sets what slab is being altered?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.simple.aniso_filter">
<span class="sig-prename descclassname"><span class="pre">simple.simple.</span></span><span class="sig-name descname"><span class="pre">aniso_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.aniso_filter" title="Permalink to this definition"></a></dt>
<dd><p>Filter for k_perp and k_par modes separately.
Applies to an pmesh mesh object as a regular filter.</p>
<dl class="simple">
<dt>Uses globally defined variables:</dt><dd><p>sigma_perp - ‘angular’ smoothing in the flat sky approximation
sigma_par - ‘radial’ smoothing from number of channels.</p>
</dd>
<dt>Usage:</dt><dd><p>mesh.apply(perp_filter, mode=’complex’, kind=’wavenumber’)</p>
</dd>
</dl>
<p>NOTES:
k[0] <a href="#id3"><span class="problematic" id="id4">*</span></a>= modifies the next iteration in the loop.
Coordinates are fixed except for the k[1] which are
the coordinate that sets what slab is being altered?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.simple.aniso_filter_gaussian">
<span class="sig-prename descclassname"><span class="pre">simple.simple.</span></span><span class="sig-name descname"><span class="pre">aniso_filter_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.simple.aniso_filter_gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Filter for k_perp and k_par modes separately.
Applies to an pmesh mesh object as a regular filter.</p>
<dl class="simple">
<dt>Uses globally defined variables:</dt><dd><p>sigma_perp - ‘angular’ smoothing in the flat sky approximation
sigma_par - ‘radial’ smoothing from number of channels.</p>
</dd>
<dt>Usage:</dt><dd><p>mesh.apply(perp_filter, mode=’complex’, kind=’wavenumber’)</p>
</dd>
</dl>
<p>NOTES:
k[0] <a href="#id5"><span class="problematic" id="id6">*</span></a>= modifies the next iteration in the loop.
Coordinates are fixed except for the k[1] which are
the coordinate that sets what slab is being altered?</p>
</dd></dl>

</section>
<section id="module-simple.tools">
<span id="simple-tools-module"></span><h2>simple.tools module<a class="headerlink" href="#module-simple.tools" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simple.tools.apply_selection_function_by_position">
<span class="sig-prename descclassname"><span class="pre">simple.tools.</span></span><span class="sig-name descname"><span class="pre">apply_selection_function_by_position</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools.apply_selection_function_by_position" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools.catalog_to_mesh_cython">
<span class="sig-prename descclassname"><span class="pre">simple.tools.</span></span><span class="sig-name descname"><span class="pre">catalog_to_mesh_cython</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools.catalog_to_mesh_cython" title="Permalink to this definition"></a></dt>
<dd><p>NGP assignment of galaxies with weights (e.g. intensity) to a mesh.</p>
<dl class="simple">
<dt>Positions: array-like</dt><dd><p>Array of shape (N_gal, 3) containing the positions of the galaxies.</p>
</dd>
<dt>Weights: array-like</dt><dd><p>Array of shape (N_gal,) containing the weights (e.g., intensity) of the galaxies.</p>
</dd>
<dt>N_mesh: tuple</dt><dd><p>Tuple of three integers (N_x, N_y, N_z) specifying the dimensions of the mesh.</p>
</dd>
<dt>Box_Size: array-like</dt><dd><p>Size of the box enclosing the mesh, array of shape (3,).</p>
</dd>
</dl>
<dl class="simple">
<dt>mesh: ndarray</dt><dd><p>Array of shape (N_x, N_y, N_z) representing the mesh with assigned weights.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools.downsample_mask">
<span class="sig-prename descclassname"><span class="pre">simple.tools.</span></span><span class="sig-name descname"><span class="pre">downsample_mask</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools.downsample_mask" title="Permalink to this definition"></a></dt>
<dd><p>Downsample a 3D mask array by averaging neighboring elements.</p>
<dl class="simple">
<dt>old_array: ndarray</dt><dd><p>Array of shape (nx, ny, nz) representing the original mask.</p>
</dd>
<dt>nx: int</dt><dd><p>Number of elements along the x-axis in the original mask.</p>
</dd>
<dt>ny: int</dt><dd><p>Number of elements along the y-axis in the original mask.</p>
</dd>
<dt>nz: int</dt><dd><p>Number of elements along the z-axis in the original mask.</p>
</dd>
</dl>
<dl class="simple">
<dt>new_array: ndarray</dt><dd><p>Array of shape (nx // 2, ny // 2, nz // 2) representing the downsampled mask.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools.get_kspec_cython">
<span class="sig-prename descclassname"><span class="pre">simple.tools.</span></span><span class="sig-name descname"><span class="pre">get_kspec_cython</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools.get_kspec_cython" title="Permalink to this definition"></a></dt>
<dd><p>Getting the wavenumber vectors k, their parallel and perpendicular components, their norm, and mu. From <a class="reference external" href="https://github.com/cblakeastro/intensitypower/tree/master">https://github.com/cblakeastro/intensitypower/tree/master</a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools.getindep_cython">
<span class="sig-prename descclassname"><span class="pre">simple.tools.</span></span><span class="sig-name descname"><span class="pre">getindep_cython</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools.getindep_cython" title="Permalink to this definition"></a></dt>
<dd><p>From <a class="reference external" href="https://github.com/cblakeastro/intensitypower/tree/master">https://github.com/cblakeastro/intensitypower/tree/master</a>.</p>
</dd></dl>

</section>
<section id="module-simple.tools_python">
<span id="simple-tools-python-module"></span><h2>simple.tools_python module<a class="headerlink" href="#module-simple.tools_python" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.bin_Pk_2d">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">bin_Pk_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_perp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.bin_Pk_2d" title="Permalink to this definition"></a></dt>
<dd><p>Bins the power spectrum into a grid of given k_bins in the perpendicular and parallel to the LOS directions.</p>
<dl class="simple">
<dt>pkspec: array-like (1D)</dt><dd><p>Power spectrum data to be binned.
Flattened 3D array.</p>
</dd>
<dt>k_bins: array-like</dt><dd><p>Array specifying the bin edges for both k_par and k_perp.</p>
</dd>
<dt>k_par: array-like (1D)</dt><dd><p>Array of k_parallel values corresponding to pkspec.
Flattened 3D array.</p>
</dd>
<dt>k_perp: array-like (1D)</dt><dd><p>Array of k_perpendicular values corresponding to pkspec.</p>
</dd>
</dl>
<dl class="simple">
<dt>P_k_2d: array</dt><dd><p>Binned 2D power spectrum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.bin_Pk_mu">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">bin_Pk_mu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_bins</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.bin_Pk_mu" title="Permalink to this definition"></a></dt>
<dd><p>Bins the power spectrum into a grid of given k_bins and mu_bins.</p>
<dl class="simple">
<dt>pkspec: array-like (1D)</dt><dd><p>Power spectrum data to be binned. Flattened 3D array.</p>
</dd>
<dt>k_bins: array-like</dt><dd><p>Array specifying the bin edges for k values.</p>
</dd>
<dt>kspec: array-like (1D)</dt><dd><p>Array of k values corresponding to pkspec.
Flattened 3D array.</p>
</dd>
<dt>muspec: array-like (1D)</dt><dd><p>Array of mu values corresponding to pkspec.
Flattened 3D array.</p>
</dd>
<dt>mu_bins: array-like</dt><dd><p>Array specifying the bin edges for mu values.</p>
</dd>
</dl>
<dl class="simple">
<dt>mean_k_2d: array</dt><dd><p>Binned mean k values in the 2D grid.</p>
</dd>
<dt>mean_mu_2d: array</dt><dd><p>Binned mean mu values in the 2D grid.</p>
</dd>
<dt>P_k_mu: array</dt><dd><p>Binned power spectrum.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.bin_scipy">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">bin_scipy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pkspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_bins</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muspec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_nmodes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.bin_scipy" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the monopole and quadrupole (if lmax==2) power spectrum and mean k in the given k bins.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pkspec</strong> (<em>array-like</em><em> (</em><em>1D</em><em>)</em>) – Array of power spectrum values.
Flattened 3D array.</p></li>
<li><p><strong>k_bins</strong> (<em>array-like</em><em> (</em><em>1D</em><em>)</em>) – Array of bin edges for the k values.</p></li>
<li><p><strong>kspec</strong> (<em>array-like</em><em> (</em><em>1D</em><em>)</em>) – Array of k values corresponding to pkspec.
Flattened 3D array.</p></li>
<li><p><strong>muspec</strong> (<em>array-like</em><em> (</em><em>1D</em><em>)</em>) – Array of mu values corresponding to pkspec.
Flattened 3D array.</p></li>
<li><p><strong>lmax</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum multipole moment to calculate.
Options: 1, 2
Default: 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mean_k</strong> (<em>ndarray</em>) – Mean k values in each k bin.</p></li>
<li><p><strong>monopole</strong> (<em>ndarray</em>) – Mean monopole power spectrum in each k bin.</p></li>
<li><p><strong>quadrupole</strong> (<em>ndarray (or None if lmax==1)</em>) – Mean quadrupole power spectrum in each k bin.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.get_checker_mask">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">get_checker_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_mesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N_cells</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.get_checker_mask" title="Permalink to this definition"></a></dt>
<dd><p>Generates a checkerboard mask for a 3D grid.
The mask is constant along the first axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>N_mesh</strong> (<em>array-like</em>) – Number of cells in each dimension (3D grid).</p></li>
<li><p><strong>N_cells</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of cells per checkerboard cell (default is 1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Checkerboard mask for the specified 3D grid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.get_cylinder_mask">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">get_cylinder_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">N_mesh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.get_cylinder_mask" title="Permalink to this definition"></a></dt>
<dd><p>Generates a mask for a cylindrical region in a 3D grid.
The cylinder is elongated in the first axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>N_mesh</strong> (<em>array-like</em>) – Number of cells in each dimension (3D grid).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cylindrical mask indicating the region of interest.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.jinc">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">jinc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.jinc" title="Permalink to this definition"></a></dt>
<dd><p>Returns the Jinc function for x!=0 and the limit 0.5 at x==0.
The Jinc function is the first Bessel function of x divided by x.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.log_interp1d">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">log_interp1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kind</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds_error</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'extrapolate'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.log_interp1d" title="Permalink to this definition"></a></dt>
<dd><p>Logarithmic interpolation accepting linear quantities as input (transformed within the function).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xx</strong> (<em>array-like</em>) – Array of x values.</p></li>
<li><p><strong>yy</strong> (<em>array-like</em>) – Array of y values.</p></li>
<li><p><strong>kind</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies the kind of interpolation. Default is ‘linear’.</p></li>
<li><p><strong>bounds_error</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, raise an error when attempting to interpolate outside the bounds of the input data. Default is False.</p></li>
<li><p><strong>fill_value</strong> (<em>str</em><em> or </em><em>numeric</em><em>, </em><em>optional</em>) – Specifies the value to use for points outside the bounds of the input data when bounds_error is False. Default is ‘extrapolate’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A callable function that performs logarithmic interpolation on input values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.make_map">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">make_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nmesh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">BoxSize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'real'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.make_map" title="Permalink to this definition"></a></dt>
<dd><p>Returns a pmesh.RealField object from an array ‘m’ as input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> (<em>array</em>) – Numpy array to be transformed into a pmesh.RealField object.</p></li>
<li><p><strong>Nmesh</strong> (<em>array</em>) – Array with dimension (3,) with the number of cells in each dimension.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.print_memory_usage">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">print_memory_usage</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.print_memory_usage" title="Permalink to this definition"></a></dt>
<dd><p>Prints the current memory usage in GB.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.transform_bin_to_h5">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">transform_bin_to_h5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bin_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h5_filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.transform_bin_to_h5" title="Permalink to this definition"></a></dt>
<dd><p>Transforms a binary file containing galaxy data from lognormal_galaxies into an HDF5 file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bin_filename</strong> (<em>str</em>) – Path to the binary output file containing the galaxy catalog from lognormal_galaxies.</p></li>
<li><p><strong>h5_filename</strong> (<em>str</em><em>, </em><em>optional</em>) – Path to the output HDF5 file.
If not provided, the output file will be created with the same name as the input file,
but with the extension ‘.h5’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>h5_filename</em> – Path to the output HDF5 file</p></li>
<li><p><em>N_gal</em> – Number of galaxies.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.yaml_file_to_dictionary">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">yaml_file_to_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.yaml_file_to_dictionary" title="Permalink to this definition"></a></dt>
<dd><p>Opens a yaml file and returns a dictionary from its contents.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="simple.tools_python.yaml_stream_to_dictionary">
<span class="sig-prename descclassname"><span class="pre">simple.tools_python.</span></span><span class="sig-name descname"><span class="pre">yaml_stream_to_dictionary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stream</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#simple.tools_python.yaml_stream_to_dictionary" title="Permalink to this definition"></a></dt>
<dd><p>Uses an opened yaml file and returns the dicionary.</p>
</dd></dl>

</section>
<section id="module-simple">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-simple" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Maja Lujan Niemeyer, Jose Luis Bernal.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>